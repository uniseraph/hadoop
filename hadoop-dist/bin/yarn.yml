rm:
  image: acs-reg.alipay.com/hadoop/hadoop:2.7.2-d527ac5
  restart: always
  net: ${NETWORK}
  container_name: rm1
  command: ./bin/yarn --config ./etc/hadoop  resourcemanager
  environment:
   - "affinity:container!=*resourcemanager*"
nm1:
  image: acs-reg.alipay.com/hadoop/hadoop:2.7.2-d527ac5
  restart: always
  net: ${NETWORK}
  hostname: nm1
  container_name: nm1
  command: ./bin/yarn --config ./etc/hadoop  nodemanager
  volumes:
   - /usr/bin/docker:/usr/bin/docker
   - /var/run/docker.sock:/var/run/docker.sock
  environment:
   - "affinity:container!=*nodemanager*"
   - "YARN_ROOT_LOGGER=DEBUG,console"
   - "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm1 "
   #- "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm1 -Dyarn.nodemanager.docker-container-executor.exec-name=/usr/bin/docker -Dyarn.nodemanager.container-executor.class=org.apache.hadoop.yarn.server.nodemanager.NativeDockerExecutor"
nm2:
  image: acs-reg.alipay.com/hadoop/hadoop:2.7.2-d527ac5
  restart: always
  net: ${NETWORK}
  hostname: nm2
  container_name: nm2
  command: ./bin/yarn --config ./etc/hadoop  nodemanager
  volumes:
   - /usr/bin/docker:/usr/bin/docker
   - /var/run/docker.sock:/var/run/docker.sock
  environment:
   - "affinity:container!=*nodemanager*"
   - "YARN_ROOT_LOGGER=DEBUG,console"
   - "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm2 "
   #- "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm2 -Dyarn.nodemanager.docker-container-executor.exec-name=/usr/bin/docker -Dyarn.nodemanager.container-executor.class=org.apache.hadoop.yarn.server.nodemanager.NativeDockerExecutor"
nm3:
  image: acs-reg.alipay.com/hadoop/hadoop:2.7.2-d527ac5
  restart: always
  net: ${NETWORK}
  hostname: nm3
  container_name: nm3
  command: ./bin/yarn --config ./etc/hadoop  nodemanager
  volumes:
   - /usr/bin/docker:/usr/bin/docker
   - /var/run/docker.sock:/var/run/docker.sock
  environment:
   - "affinity:container!=*nodemanager*"
   - "YARN_ROOT_LOGGER=DEBUG,console"
   - "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm3"
   #- "YARN_NODEMANAGER_OPTS=-Dyarn.resourcemanager.hostname=rm1 -Dyarn.nodemanager.hostname=nm3 -Dyarn.nodemanager.docker-container-executor.exec-name=/usr/bin/docker -Dyarn.nodemanager.container-executor.class=org.apache.hadoop.yarn.server.nodemanager.NativeDockerExecutor"

